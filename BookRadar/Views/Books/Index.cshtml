@model BookRadar.Web.Models.BookSearchPageVm
@{
    ViewData["Title"] = "Inicio";
}

<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="hero-content text-center">
            <div class="hero-icon mb-4">
                <i class="fas fa-book-open"></i>
            </div>
            <h1 class="hero-title mb-3">BookRadar</h1>
            <p class="hero-subtitle mb-4">Encuentra tu pr√≥ximo libro favorito en segundos</p>
            
            <div class="hero-stats">
                <form asp-action="Index" method="post" class="search-form" id="searchForm">
                    @Html.AntiForgeryToken()
                    
                    <!-- B√∫squeda Principal - M√°s Prominente -->
                    <div class="main-search-section">
                        <div class="search-tabs mb-3">
                            <div class="nav nav-tabs" id="searchTabs" role="tablist">
                                <button class="nav-link active" id="autor-tab" data-bs-toggle="tab" data-bs-target="#autor-search" type="button" role="tab">
                                    <i class="fas fa-user me-2"></i>Buscar por Autor
                                </button>
                                @* <button class="nav-link" id="titulo-tab" data-bs-toggle="tab" data-bs-target="#titulo-search" type="button" role="tab">
                                    <i class="fas fa-book me-2"></i>Buscar por T√≠tulo
                                </button> *@
                                @* <button class="nav-link" id="avanzada-tab" data-bs-toggle="tab" data-bs-target="#avanzada-search" type="button" role="tab">
                                    <i class="fas fa-search-plus me-2"></i>B√∫squeda Avanzada
                                </button> *@
                            </div>
                        </div>

                        <div class="tab-content" id="searchTabContent">
                            <!-- B√∫squeda por Autor -->
                            <div class="tab-pane fade show active" id="autor-search" role="tabpanel">
                                <div class="search-input-group">
                                    <label for="Autor" class="search-label">
                                        <i class="fas fa-user"></i>
                                        ¬øQu√© autor te gustar√≠a buscar?
                                    </label>
                                    <div class="search-input-wrapper">
                                        <input asp-for="Autor" 
                                               class="search-input @(ViewData.ModelState[nameof(Model.Autor)]?.Errors.Any() == true ? "is-invalid" : "")"
                                               placeholder="Ej: Gabriel Garc√≠a M√°rquez, Stephen King, Isabel Allende..." 
                                               maxlength="100" 
                                               id="Autor" />
                                    </div>
                                </div>
                            </div>

                            <!-- B√∫squeda por T√≠tulo -->
                            <div class="tab-pane fade" id="titulo-search" role="tabpanel">
                                <div class="search-input-group">
                                    <label for="Titulo" class="search-label">
                                        <i class="fas fa-book"></i>
                                        ¬øQu√© t√≠tulo te gustar√≠a buscar?
                                    </label>
                                    <div class="search-input-wrapper">
                                        <input asp-for="Titulo" 
                                               class="search-input @(ViewData.ModelState[nameof(Model.Titulo)]?.Errors.Any() == true ? "is-invalid" : "")"
                                               placeholder="Ej: Cien a√±os de soledad, El Se√±or de los Anillos..." 
                                               maxlength="200" 
                                               id="Titulo" />
                                    </div>
                                </div>
                            </div>

                            <!-- B√∫squeda Avanzada -->
                            <div class="tab-pane fade" id="avanzada-search" role="tabpanel">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="TituloAvanzado" class="search-label">
                                            <i class="fas fa-book"></i>
                                            T√≠tulo
                                        </label>
                                        <input asp-for="Titulo" 
                                               class="form-control" 
                                               placeholder="T√≠tulo del libro..." 
                                               maxlength="200" 
                                               id="TituloAvanzado" />
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="AutorAvanzado" class="search-label">
                                            <i class="fas fa-user"></i>
                                            Autor
                                        </label>
                                        <input asp-for="Autor" 
                                               class="form-control" 
                                               placeholder="Nombre del autor..." 
                                               maxlength="100" 
                                               id="AutorAvanzado" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label for="IdiomaAvanzado" class="search-label">
                                            <i class="fas fa-language"></i>
                                            Idioma
                                        </label>
                                        <select asp-for="Idioma" class="form-select" id="IdiomaAvanzado">
                                            <option value="">Todos los idiomas</option>
                                            @foreach (var idioma in BookRadar.Web.Models.BookSearchPageVm.IdiomasDisponibles)
                                            {
                                                <option value="@idioma">@idioma.ToUpper()</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label for="FormatoAvanzado" class="search-label">
                                            <i class="fas fa-file-alt"></i>
                                            Formato
                                        </label>
                                        <select asp-for="Formato" class="form-select" id="FormatoAvanzado">
                                            <option value="">Todos los formatos</option>
                                            @foreach (var formato in BookRadar.Web.Models.BookSearchPageVm.FormatosDisponibles)
                                            {
                                                <option value="@formato">@formato</option>
                                            }
                                        </select>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label for="AnioDesdeAvanzado" class="search-label">
                                            <i class="fas fa-calendar"></i>
                                            A√±o desde
                                        </label>
                                        <input asp-for="AnioDesde" 
                                               class="form-control" 
                                               type="number" 
                                               min="1800" 
                                               max="2030" 
                                               placeholder="1800" 
                                               id="AnioDesdeAvanzado" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label for="AnioHastaAvanzado" class="search-label">
                                            <i class="fas fa-calendar"></i>
                                            A√±o hasta
                                        </label>
                                        <input asp-for="AnioHasta" 
                                               class="form-control" 
                                               type="number" 
                                               min="1800" 
                                               max="2030" 
                                               placeholder="2030" 
                                               id="AnioHastaAvanzado" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Bot√≥n de b√∫squeda com√∫n -->
                        <div class="search-button-wrapper mt-3">
                            <button type="submit" class="search-button" id="searchButton">
                                <i class="fas fa-search"></i>
                                <span>Buscar Libros</span>
                            </button>
                        </div>
                    </div>

                    <!-- Opciones de B√∫squeda -->
                   @*  <div class="search-options mt-4">
                        <div class="search-options-card">
                            <div class="search-options-header">
                                <div class="search-options-title">
                                    <i class="fas fa-tune"></i>
                                    <span>Opciones de B√∫squeda</span>
                                </div>
                                <div class="search-options-subtitle">
                                    Personaliza tu b√∫squeda seg√∫n tus necesidades
                                </div>
                            </div>
                            
                            <div class="search-options-content">
                                <!-- Opciones Principales -->
                                <div class="search-option-group">
                                    <div class="search-option-item" data-option="limitado">
                                        <div class="option-radio">
                                            <input type="radio" name="TipoBusquedaResultados" value="limitado" id="limitado" 
                                                   @(Model.TipoBusquedaResultados == "limitado" ? "checked" : "") />
                                            <label for="limitado" class="option-label">
                                                <div class="option-icon">
                                                    <i class="fas fa-bolt"></i>
                                                </div>
                                                <div class="option-content">
                                                    <div class="option-title">B√∫squeda R√°pida</div>
                                                    <div class="option-description">Hasta 100 resultados en segundos</div>
                                                </div>
                                                <div class="option-badge">Recomendado</div>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="search-option-item" data-option="completo">
                                        <div class="option-radio">
                                            <input type="radio" name="TipoBusquedaResultados" value="completo" id="completo" 
                                                   @(Model.TipoBusquedaResultados == "completo" ? "checked" : "") />
                                            <label for="completo" class="option-label">
                                                <div class="option-icon">
                                                    <i class="fas fa-search-plus"></i>
                                                </div>
                                                <div class="option-content">
                                                    <div class="option-title">B√∫squeda Completa</div>
                                                    <div class="option-description">Todos los resultados disponibles</div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="search-option-item" data-option="personalizado">
                                        <div class="option-radio">
                                            <input type="radio" name="TipoBusquedaResultados" value="personalizado" id="personalizado" 
                                                   @(Model.TipoBusquedaResultados == "personalizado" ? "checked" : "") />
                                            <label for="personalizado" class="option-label">
                                                <div class="option-icon">
                                                    <i class="fas fa-sliders-h"></i>
                                                </div>
                                                <div class="option-content">
                                                    <div class="option-title">L√≠mite Personalizado</div>
                                                    <div class="option-description">Elige cu√°ntos resultados quieres</div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Opci√≥n de l√≠mite personalizado -->
                                <div class="custom-limit-section" id="limitePersonalizadoGroup" style="display: none;">
                                    <div class="custom-limit-card">
                                        <div class="custom-limit-header">
                                            <i class="fas fa-list-ol"></i>
                                            <span>¬øCu√°ntos libros quieres ver?</span>
                                        </div>
                                        <div class="custom-limit-content">
                                            <select asp-for="LimiteResultados" class="custom-limit-select">
                                                @foreach (var limite in BookRadar.Web.Models.BookSearchPageVm.LimitesPredefinidos)
                                                {
                                                    <option value="@limite">@limite.ToString("N0") libros</option>
                                                }
                                            </select>
                                            <div class="custom-limit-help">
                                                <i class="fas fa-info-circle"></i>
                                                Cantidades mayores pueden tomar m√°s tiempo
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Opci√≥n de b√∫squeda completa -->
                                <div class="search-all-section">
                                    <div class="search-all-card">
                                        <div class="search-all-content">
                                            <div class="search-all-checkbox">
                                                <input asp-for="BuscarTodosLosResultados" type="checkbox" id="buscarTodosCheck" />
                                                <label for="BuscarTodosLosResultados" class="search-all-label">
                                                    <div class="search-all-icon">
                                                        <i class="fas fa-infinity"></i>
                                                    </div>
                                                    <div class="search-all-text">
                                                        <span>Buscar TODOS los resultados disponibles</span>
                                                        <small>‚ö†Ô∏è Puede tomar varios minutos</small>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Informaci√≥n contextual -->
                            <div class="search-info-tips">
                                <div class="info-tip-card">
                                    <div class="info-tip-icon">
                                        <i class="fas fa-lightbulb"></i>
                                    </div>
                                    <div class="info-tip-content">
                                        <div class="info-tip-title">üí° Consejo:</div>
                                        <div class="info-tip-text" id="searchTipText">
                                            Para empezar, usa "B√∫squeda R√°pida" y obt√©n hasta 100 resultados en segundos.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> *@



                    @if (!string.IsNullOrWhiteSpace(Model?.Message))
                    {
                        <div class="alert alert-info mt-4" role="alert">
                            <i class="fas fa-info-circle me-2"></i>
                            @Model.Message
                        </div>
                    }

                    @if (!ViewData.ModelState.IsValid)
                    {
                        <div class="alert alert-danger mt-3" role="alert">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>Por favor, corrige los siguientes errores:</strong>
                            <ul class="mb-0 mt-2">
                                @foreach (var modelState in ViewData.ModelState.Values)
                                {
                                    foreach (var error in modelState.Errors)
                                    {
                                        <li>@error.ErrorMessage</li>
                                    }
                                }
                            </ul>
                        </div>
                    }
                </form>
            </div>
        </div>
    </div>
</section>

<!-- Results Section -->
@if (Model?.Resultados?.Any() == true)
{
    <section class="results-section">
        <div class="container">
            <div class="results-wrapper">
                <div class="results-header">
                    <h3 class="results-title">
                        <i class="fas fa-star me-2"></i>
                        Resultados de la b√∫squeda
                    </h3>
                    <span class="results-badge">
                        @Model.Resultados.Count libro@(Model.Resultados.Count != 1 ? "s" : "")
                        @if (Model.TotalItems > Model.Resultados.Count)
                        {
                            <span class="text-muted">de @Model.TotalItems.ToString("N0") disponibles</span>
                        }
                    </span>
                </div>
                
                <!-- Informaci√≥n de la b√∫squeda -->
                <div class="search-info mb-3">
                    <div class="row">
                        <div class="col-md-6">
                            <small class="text-muted">
                                <i class="fas fa-info-circle me-1"></i>
                                @if (Model.BuscarTodosLosResultados)
                                {
                                    <span>B√∫squeda completa realizada</span>
                                }
                                else if (Model.TipoBusquedaResultados == "personalizado")
                                {
                                    <span>L√≠mite personalizado: @Model.LimiteResultados.ToString("N0") libros</span>
                                }
                                else
                                {
                                    <span>L√≠mite est√°ndar: 100 libros</span>
                                }
                            </small>
                        </div>
                        <div class="col-md-6 text-end">
                            @if (Model.TotalItems > Model.Resultados.Count)
                            {
                                <small class="text-warning">
                                    <i class="fas fa-exclamation-triangle me-1"></i>
                                    Algunos resultados pueden no haberse cargado completamente
                                </small>
                            }
                        </div>
                    </div>
                </div>

                <!-- Panel de Filtros y B√∫squeda Avanzada -->
                <div class="filters-panel mb-4" id="filtersPanel">
                    <div class="filters-header">
                        <div class="filters-title">
                            <i class="fas fa-filter"></i>
                            <span>Filtros y B√∫squeda Avanzada</span>
                        </div>
                        <button type="button" class="btn btn-outline-primary btn-sm" id="toggleFiltersBtn">
                            <i class="fas fa-chevron-down"></i>
                            <span>Mostrar Filtros</span>
                        </button>
                    </div>
                    
                    <div class="filters-content" id="filtersContent" style="display: none;">
                        <div class="row">
                            <!-- B√∫squeda en resultados -->
                            <div class="col-md-6 mb-3">
                                <div class="filter-group">
                                    <label for="searchInResults" class="filter-label">
                                        <i class="fas fa-search"></i>
                                        Buscar en resultados
                                    </label>
                                    <div class="search-input-group-sm">
                                        <input type="text" 
                                               class="form-control" 
                                               id="searchInResults" 
                                               placeholder="Filtrar por t√≠tulo, autor, a√±o, idioma..." />
                                        <button type="button" class="btn btn-primary btn-sm" id="applySearchFilter">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Filtro por idioma -->
                            @* <div class="col-md-3 mb-3">
                                <div class="filter-group">
                                    <label for="languageFilter" class="filter-label">
                                        <i class="fas fa-language"></i>
                                        Idioma
                                    </label>
                                    <select class="form-select" id="languageFilter">
                                        <option value="">Todos los idiomas</option>
                                        <option value="es">Espa√±ol</option>
                                        <option value="en">Ingl√©s</option>
                                        <option value="fr">Franc√©s</option>
                                        <option value="de">Alem√°n</option>
                                        <option value="it">Italiano</option>
                                        <option value="pt">Portugu√©s</option>
                                    </select>
                                </div>
                            </div> *@
                            
                            <!-- Filtro por a√±o -->
                            <div class="col-md-3 mb-3">
                                <div class="filter-group">
                                    <label for="yearFilter" class="filter-label">
                                        <i class="fas fa-calendar"></i>
                                        A√±o
                                    </label>
                                    <select class="form-select" id="yearFilter">
                                        <option value="">Todos los a√±os</option>
                                        <option value="2020-2024">2020-2024</option>
                                        <option value="2010-2019">2010-2019</option>
                                        <option value="2000-2009">2000-2009</option>
                                        <option value="1990-1999">1990-1999</option>
                                        <option value="1980-1989">1980-1989</option>
                                        <option value="1970-1979">1970-1979</option>
                                        <option value="1960-1969">1960-1969</option>
                                        <option value="1950-1959">1950-1959</option>
                                        <option value="1900-1949">1900-1949</option>
                                        <option value="1800-1899">1800-1899</option>
                                        <option value="1700-1799">1700-1799</option>
                                        <option value="1600-1699">1600-1699</option>
                                        <option value="1500-1599">1500-1599</option>
                                        <option value="1400-1499">1400-1499</option>
                                        <option value="1300-1399">1300-1399</option>
                                        <option value="1200-1299">1200-1299</option>
                                        <option value="1100-1199">1100-1199</option>
                                        <option value="1000-1099">1000-1099</option>
                                        <option value="0-999">Antes del a√±o 1000</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                        @*     <!-- Filtro por n√∫mero de p√°ginas -->
                            <div class="col-md-3 mb-3">
                                <div class="filter-group">
                                    <label for="pagesFilter" class="filter-label">
                                        <i class="fas fa-file-alt"></i>
                                        P√°ginas
                                    </label>
                                    <select class="form-select" id="pagesFilter">
                                        <option value="">Cualquier longitud</option>
                                        <option value="0-100">0-100 p√°ginas</option>
                                        <option value="101-300">101-300 p√°ginas</option>
                                        <option value="301-500">301-500 p√°ginas</option>
                                        <option value="501-800">501-800 p√°ginas</option>
                                        <option value="801-1200">801-1200 p√°ginas</option>
                                        <option value="1201+">M√°s de 1200 p√°ginas</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Filtro por disponibilidad -->
                            <div class="col-md-3 mb-3">
                                <div class="filter-group">
                                    <label for="availabilityFilter" class="filter-label">
                                        <i class="fas fa-check-circle"></i>
                                        Disponibilidad
                                    </label>
                                    <select class="form-select" id="availabilityFilter">
                                        <option value="">Todos</option>
                                        <option value="available">Disponible</option>
                                        <option value="not-available">No disponible</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Ordenar por -->
                            <div class="col-md-3 mb-3">
                                <div class="filter-group">
                                    <label for="sortBy" class="filter-label">
                                        <i class="fas fa-sort"></i>
                                        Ordenar por
                                    </label>
                                    <select class="form-select" id="sortBy">
                                        <option value="relevance">Relevancia</option>
                                        <option value="title">T√≠tulo A-Z</option>
                                        <option value="title-desc">T√≠tulo Z-A</option>
                                        <option value="year">A√±o (m√°s reciente)</option>
                                        <option value="year-asc">A√±o (m√°s antiguo)</option>
                                        <option value="pages">P√°ginas (menos a m√°s)</option>
                                        <option value="pages-desc">P√°ginas (m√°s a menos)</option>
                                    </select>
                                </div>
                            </div> *@
                            
                            <!-- Botones de acci√≥n -->
                            <div class="col-md-3 mb-3">
                                <div class="filter-actions">
                                    <button type="button" class="btn btn-success btn-sm me-2" id="applyFiltersBtn">
                                        <i class="fas fa-check"></i>
                                        Aplicar Filtros
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary btn-sm" id="clearFiltersBtn">
                                        <i class="fas fa-times"></i>
                                        Limpiar
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Contador de resultados filtrados -->
                        <div class="filtered-results-info mt-3" id="filteredResultsInfo" style="display: none;">
                            <div class="alert alert-info mb-0">
                                <i class="fas fa-info-circle me-2"></i>
                                <span id="filteredResultsText">Mostrando resultados filtrados</span>
                                <button type="button" class="btn btn-outline-info btn-sm ms-2" id="showAllResultsBtn">
                                    <i class="fas fa-eye"></i>
                                    Mostrar todos
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <partial name="_Results" model="Model.Resultados" />
                
                <!-- Mensaje de no hay resultados filtrados -->
                <div class="no-filtered-results" id="noFilteredResults" style="display: none;">
                    <div class="empty-state text-center py-5">
                        <div class="empty-icon mb-3">
                            <i class="fas fa-search fa-3x text-muted"></i>
                        </div>
                        <h4 class="empty-title">No se encontraron resultados</h4>
                        <p class="empty-description">
                            No hay libros que coincidan con los filtros seleccionados.
                            <br>
                            Intenta ajustar tus criterios de b√∫squeda.
                        </p>
                        <button type="button" class="btn btn-primary" id="resetFiltersBtn">
                            <i class="fas fa-undo"></i>
                            Restablecer Filtros
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>
}

<!-- Features Section -->
<section class="features-section">
    <div class="container">
        <div class="features-wrapper">
            <div class="section-header text-center">
                <h3 class="section-title">¬øPor qu√© elegir BookRadar?</h3>
                <p class="section-subtitle">La forma m√°s f√°cil de encontrar tu pr√≥ximo libro</p>
            </div>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <h4>B√∫squeda Inteligente</h4>
                    <p>Encuentra libros de cualquier autor con nuestra b√∫squeda optimizada</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <h4>Base de Datos Completa</h4>
                    <p>Accede a millones de libros a trav√©s de la API de Open Library</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <h4>Historial Persistente</h4>
                    <p>Mant√©n un registro de todas tus b√∫squedas y descubrimientos</p>
                </div>
                
                @* <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-infinity"></i>
                    </div>
                    <h4>B√∫squeda Completa</h4>
                    <p>Obt√©n todos los resultados disponibles, no solo los primeros 100</p>
                </div> *@
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script src="~/js/validation-config.js"></script>
    <script src="~/js/validation.js"></script>
    <script src="~/js/enhanced-ux.js"></script>
    <script src="~/js/filters-manager.js"></script>
    <script src="~/js/search-tabs.js"></script>
    <script>
        // Configuraci√≥n espec√≠fica para la p√°gina de b√∫squeda
        document.addEventListener('DOMContentLoaded', function() {
            // Funci√≥n para mostrar loading en el bot√≥n de b√∫squeda
            function showLoading() {
                if (window.BookRadarUtils) {
                    window.BookRadarUtils.showLoading('searchButton', 'Buscando...');
                }
            }

            // Agregar loading al formulario
            document.getElementById('searchForm').addEventListener('submit', showLoading);

            // Configurar validaci√≥n en tiempo real
            const autorInput = document.querySelector('input[name="Autor"]');
            if (autorInput) {
                autorInput.addEventListener('input', function() {
                    // La validaci√≥n se maneja autom√°ticamente por el validador de jQuery
                    this.classList.remove('is-invalid', 'is-valid');
                });
            }

            // Manejar cambios en el tipo de b√∫squeda
            const searchOptionItems = document.querySelectorAll('.search-option-item');
            const limitePersonalizadoGroup = document.getElementById('limitePersonalizadoGroup');
            const buscarTodosCheck = document.getElementById('buscarTodosCheck');
            const searchTipText = document.getElementById('searchTipText');

            function actualizarOpcionesBusqueda() {
                const tipoSeleccionado = document.querySelector('input[name="TipoBusquedaResultados"]:checked')?.value || 'limitado';
                const buscarTodos = buscarTodosCheck.checked;

                if (buscarTodos) {
                    // Si se selecciona buscar todos, deshabilitar otras opciones
                    searchOptionItems.forEach(item => {
                        const radio = item.querySelector('input[type="radio"]');
                        radio.disabled = true;
                        item.classList.add('disabled');
                    });
                    limitePersonalizadoGroup.style.display = 'none';
                    buscarTodosCheck.checked = true;
                    searchTipText.innerHTML = '‚ö†Ô∏è <strong>B√∫squeda completa activada:</strong> Se buscar√°n todos los resultados disponibles. Esto puede tomar varios minutos.';
                } else {
                    // Habilitar opciones seg√∫n el tipo seleccionado
                    searchOptionItems.forEach(item => {
                        const radio = item.querySelector('input[type="radio"]');
                        radio.disabled = false;
                        item.classList.remove('disabled');
                    });
                    
                    if (tipoSeleccionado === 'personalizado') {
                        limitePersonalizadoGroup.style.display = 'block';
                        searchTipText.innerHTML = 'üí° <strong>L√≠mite personalizado:</strong> Selecciona cu√°ntos libros quieres obtener. Cantidades mayores pueden tomar m√°s tiempo.';
                    } else if (tipoSeleccionado === 'completo') {
                        limitePersonalizadoGroup.style.display = 'none';
                        searchTipText.innerHTML = 'üîç <strong>B√∫squeda completa:</strong> Se realizar√° una b√∫squeda completa para obtener todos los resultados disponibles.';
                    } else {
                        limitePersonalizadoGroup.style.display = 'none';
                        searchTipText.innerHTML = '‚ö° <strong>B√∫squeda r√°pida:</strong> Obtendr√°s hasta 100 resultados en segundos. Perfecto para la mayor√≠a de b√∫squedas.';
                    }
                }
            }

            // Event listeners para cambios
            searchOptionItems.forEach(item => {
                const radio = item.querySelector('input[type="radio"]');
                radio.addEventListener('change', actualizarOpcionesBusqueda);
            });
            buscarTodosCheck.addEventListener('change', actualizarOpcionesBusqueda);

            // Inicializar estado
            actualizarOpcionesBusqueda();

            // Habilitar modo debug en desarrollo (opcional)
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                if (window.enableValidationDebug) {
                    window.enableValidationDebug(true);
                }
            }
        });
    </script>
}
